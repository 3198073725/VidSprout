# MediaCMS Windows å¼€å‘ç¯å¢ƒå¿«é€Ÿé…ç½®æŒ‡å—

## âœ… å½“å‰è¿›åº¦ï¼šPython ä¾èµ–å·²å®‰è£…

---

## ğŸ“ ä¸‹ä¸€æ­¥ï¼šé…ç½®å’Œåˆå§‹åŒ–

### æ­¥éª¤ 1ï¼šåˆ›å»ºæœ¬åœ°é…ç½®æ–‡ä»¶ âœ…

å·²åˆ›å»º `cms/local_settings.py` æ–‡ä»¶ï¼ŒåŒ…å«ï¼š
- âœ… æ•°æ®åº“é…ç½®ï¼ˆPostgreSQLï¼‰
- âœ… Redis é…ç½®
- âœ… CORS é…ç½®ï¼ˆå…è®¸ Vue å‰ç«¯è®¿é—®ï¼‰
- âœ… å¼€å‘ç¯å¢ƒä¼˜åŒ–è®¾ç½®

### æ­¥éª¤ 2ï¼šç¡®ä¿æ•°æ®åº“å·²é…ç½®

å¦‚æœè¿˜æ²¡æœ‰è¿è¡Œæ•°æ®åº“é…ç½®è„šæœ¬ï¼Œè¯·å…ˆè¿è¡Œï¼š

```powershell
# è¿è¡Œæ•°æ®åº“é…ç½®è„šæœ¬
.\fix-postgres-password.bat

# æˆ–ä½¿ç”¨ pgAdmin å›¾å½¢ç•Œé¢åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
```

### æ­¥éª¤ 3ï¼šåˆå§‹åŒ–æ•°æ®åº“

```powershell
# ç¡®ä¿è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»ï¼ˆçœ‹åˆ° (venv) å‰ç¼€ï¼‰
# ç¡®ä¿åœ¨é¡¹ç›®æ ¹ç›®å½•

# è¿è¡Œæ•°æ®åº“è¿ç§»
python manage.py migrate

# å¦‚æœçœ‹åˆ°é”™è¯¯ï¼Œæ£€æŸ¥ï¼š
# 1. PostgreSQL æœåŠ¡æ˜¯å¦è¿è¡Œ
# 2. æ•°æ®åº“ mediacms æ˜¯å¦å­˜åœ¨
# 3. ç”¨æˆ· mediacms å¯†ç æ˜¯å¦æ­£ç¡®
```

### æ­¥éª¤ 4ï¼šåŠ è½½åˆå§‹æ•°æ®

```powershell
# åŠ è½½ç¼–ç é…ç½®æ–‡ä»¶ï¼ˆè½¬ç é…ç½®ï¼‰
python manage.py loaddata fixtures/encoding_profiles.json

# åŠ è½½åˆ†ç±»æ•°æ®
python manage.py loaddata fixtures/categories.json
```

### æ­¥éª¤ 5ï¼šåˆ›å»ºè¶…çº§ç”¨æˆ·ï¼ˆç®¡ç†å‘˜è´¦å·ï¼‰

```powershell
# åˆ›å»ºç®¡ç†å‘˜è´¦å·
python manage.py createsuperuser

# æŒ‰æç¤ºè¾“å…¥ï¼š
# - Username: adminï¼ˆæˆ–ä½ å–œæ¬¢çš„ç”¨æˆ·åï¼‰
# - Email: admin@example.comï¼ˆå¯é€‰ï¼‰
# - Password: è®¾ç½®ä¸€ä¸ªå¼ºå¯†ç 
# - Password (again): å†æ¬¡è¾“å…¥ç¡®è®¤
```

### æ­¥éª¤ 6ï¼šæ”¶é›†é™æ€æ–‡ä»¶

```powershell
# æ”¶é›† Django é™æ€æ–‡ä»¶ï¼ˆCSSã€JSç­‰ï¼‰
python manage.py collectstatic --noinput
```

### æ­¥éª¤ 7ï¼šéªŒè¯åç«¯é…ç½®

```powershell
# æµ‹è¯•æ•°æ®åº“è¿æ¥
python manage.py check

# åº”è¯¥çœ‹åˆ°ï¼šSystem check identified no issues (0 silenced).
```

### æ­¥éª¤ 8ï¼šå¯åŠ¨åç«¯æœåŠ¡ï¼ˆæµ‹è¯•ï¼‰

```powershell
# å¯åŠ¨ Django å¼€å‘æœåŠ¡å™¨
python manage.py runserver 0.0.0.0:8000

# åº”è¯¥çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š
# Starting development server at http://0.0.0.0:8000/
# Quit the server with CTRL-BREAK.

# åœ¨æµè§ˆå™¨è®¿é—® http://localhost:8000/admin
# ä½¿ç”¨åˆšåˆ›å»ºçš„è¶…çº§ç”¨æˆ·ç™»å½•
```

å¦‚æœæˆåŠŸï¼ŒæŒ‰ `Ctrl+C` åœæ­¢æœåŠ¡å™¨ã€‚

---

## ğŸ¨ å‰ç«¯é…ç½®

### æ­¥éª¤ 1ï¼šåˆ›å»ºå‰ç«¯ç¯å¢ƒå˜é‡æ–‡ä»¶

åˆ›å»ºæ–‡ä»¶ `frontend-vue/.env.development`ï¼š

```bash
# API åŸºç¡€åœ°å€
VITE_API_BASE=http://localhost:8000/api

# æ˜¯å¦ä½¿ç”¨ CSRF
VITE_USE_CSRF=false

# Token ç›¸å…³é…ç½®
VITE_ACCESS_HEADER=Authorization
VITE_ACCESS_PREFIX=Bearer

# Token åˆ·æ–°ç«¯ç‚¹
VITE_REFRESH_ENDPOINT=http://localhost:8000/api/v1/auth/refresh
```

### æ­¥éª¤ 2ï¼šå®‰è£…å‰ç«¯ä¾èµ–

```powershell
# è¿›å…¥å‰ç«¯ç›®å½•
cd frontend-vue

# å®‰è£…ä¾èµ–
npm install

# å¦‚æœé€Ÿåº¦æ…¢ï¼Œä½¿ç”¨å›½å†…é•œåƒï¼š
npm install --registry=https://registry.npmmirror.com
```

### æ­¥éª¤ 3ï¼šéªŒè¯å‰ç«¯é…ç½®

```powershell
# æ£€æŸ¥ vite.config.ts ä¸­çš„ä»£ç†é…ç½®
# åº”è¯¥ä»£ç†åˆ° http://localhost:8000
```

---

## ğŸš€ å¯åŠ¨æ‰€æœ‰æœåŠ¡

### æ–¹å¼ä¸€ï¼šä½¿ç”¨ä¸€é”®å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

```powershell
# å›åˆ°é¡¹ç›®æ ¹ç›®å½•
cd ..

# è¿è¡Œå¯åŠ¨è„šæœ¬
.\start-dev.bat
```

è¿™ä¼šè‡ªåŠ¨å¯åŠ¨ï¼š
- Celery Worker (çŸ­ä»»åŠ¡)
- Celery Worker (é•¿ä»»åŠ¡)
- Celery Beat
- Django åç«¯
- Vue å‰ç«¯

### æ–¹å¼äºŒï¼šæ‰‹åŠ¨å¯åŠ¨ï¼ˆéœ€è¦ 5 ä¸ªç»ˆç«¯çª—å£ï¼‰

**ç»ˆç«¯ 1ï¼šRedisï¼ˆå¦‚æœä½¿ç”¨ WSLï¼‰**
```bash
wsl
sudo service redis-server start
exit
```

**ç»ˆç«¯ 2ï¼šCelery Worker (çŸ­ä»»åŠ¡)**
```powershell
cd "E:\Graduation Project\cs001\mediacms"
.\venv\Scripts\Activate.ps1
celery -A cms worker --loglevel=info -Q short_tasks -n short@%h
```

**ç»ˆç«¯ 3ï¼šCelery Worker (é•¿ä»»åŠ¡)**
```powershell
cd "E:\Graduation Project\cs001\mediacms"
.\venv\Scripts\Activate.ps1
celery -A cms worker --loglevel=info -Q long_tasks -n long@%h
```

**ç»ˆç«¯ 4ï¼šCelery Beat**
```powershell
cd "E:\Graduation Project\cs001\mediacms"
.\venv\Scripts\Activate.ps1
celery -A cms beat --loglevel=info
```

**ç»ˆç«¯ 5ï¼šDjango åç«¯**
```powershell
cd "E:\Graduation Project\cs001\mediacms"
.\venv\Scripts\Activate.ps1
python manage.py runserver 0.0.0.0:8000
```

**ç»ˆç«¯ 6ï¼šVue å‰ç«¯**
```powershell
cd "E:\Graduation Project\cs001\mediacms\frontend-vue"
npm run dev
```

---

## âœ… éªŒè¯æ¸…å•

å¯åŠ¨åéªŒè¯ï¼š

- [ ] Django åç«¯ï¼šhttp://localhost:8000/adminï¼ˆå¯ä»¥ç™»å½•ï¼‰
- [ ] API æ–‡æ¡£ï¼šhttp://localhost:8000/api/v1/
- [ ] Vue å‰ç«¯ï¼šhttp://localhost:8080ï¼ˆå¯ä»¥è®¿é—®ï¼‰
- [ ] å¯ä»¥æ³¨å†Œæ–°ç”¨æˆ·
- [ ] å¯ä»¥ç™»å½•ç³»ç»Ÿ
- [ ] å¯ä»¥ä¸Šä¼ åª’ä½“æ–‡ä»¶
- [ ] è§†é¢‘å¯ä»¥æ­£å¸¸æ’­æ”¾

---

## ğŸ¯ å¿«é€Ÿæ‰§è¡Œå‘½ä»¤ï¼ˆæŒ‰é¡ºåºï¼‰

```powershell
# 1. ç¡®ä¿æ•°æ®åº“å·²é…ç½®
.\fix-postgres-password.bat

# 2. è¿è¡Œæ•°æ®åº“è¿ç§»
python manage.py migrate

# 3. åŠ è½½åˆå§‹æ•°æ®
python manage.py loaddata fixtures/encoding_profiles.json
python manage.py loaddata fixtures/categories.json

# 4. åˆ›å»ºè¶…çº§ç”¨æˆ·
python manage.py createsuperuser

# 5. æ”¶é›†é™æ€æ–‡ä»¶
python manage.py collectstatic --noinput

# 6. éªŒè¯é…ç½®
python manage.py check

# 7. æµ‹è¯•åç«¯ï¼ˆå¯é€‰ï¼ŒæŒ‰ Ctrl+C åœæ­¢ï¼‰
python manage.py runserver 0.0.0.0:8000

# 8. é…ç½®å‰ç«¯ç¯å¢ƒå˜é‡ï¼ˆåˆ›å»º .env.developmentï¼‰
# 9. å®‰è£…å‰ç«¯ä¾èµ–
cd frontend-vue
npm install

# 10. å¯åŠ¨æ‰€æœ‰æœåŠ¡
cd ..
.\start-dev.bat
```

---

## ğŸ“š é‡åˆ°é—®é¢˜ï¼Ÿ

å‚è€ƒæ–‡æ¡£ï¼š`docs/Windowsæœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»ºè®¡åˆ’.md` ä¸­çš„"å¸¸è§é—®é¢˜æ’æŸ¥"éƒ¨åˆ†

