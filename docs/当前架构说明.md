# MediaCMS 当前架构说明

## 🏗️ 当前架构（前后端分离）

### 前端（Vue 3 SPA）
- **运行方式**：独立运行，不集成到 Django 模板
- **端口**：`http://localhost:8080`
- **技术栈**：Vue 3 + Vite + Element Plus
- **访问方式**：直接访问 `http://localhost:8080`
- **API 访问**：通过 Vite 代理访问后端 API

### 后端（Django）
- **运行方式**：提供 REST API 和模板页面（React）
- **端口**：`http://localhost:8000`
- **API 端点**：`/api/v1/*`
- **管理后台**：`http://localhost:8000/admin`（使用 Django Admin）
- **模板页面**：`http://localhost:8000/`（React 前端，可忽略）

---

## ✅ 正确的访问方式

### 使用 Vue 前端
1. **访问地址**：`http://localhost:8080`
2. **前端通过代理访问后端 API**（Vite 自动处理）
3. **不需要访问** `http://localhost:8000`（那是 React 前端）

### 使用 Django Admin
- **访问地址**：`http://localhost:8000/admin`
- **用途**：管理后台、数据库管理

---

## 📝 配置说明

### Vite 代理配置（已正确配置）

```typescript
// frontend-vue/vite.config.ts
proxy: {
  '/api': { target: 'http://localhost:8000' },      // API 代理
  '/static': { target: 'http://localhost:8000' },   // 静态文件
  '/media': { target: 'http://localhost:8000' },    // 媒体文件
  '/accounts': { target: 'http://localhost:8000' }, // 认证端点
  '/admin': { target: 'http://localhost:8000' },     // Admin（可选）
}
```

### Django CORS 配置（已正确配置）

```python
# cms/local_settings.py
CORS_ALLOWED_ORIGINS = [
    "http://localhost:8080",
    "http://127.0.0.1:8080",
]
CORS_ALLOW_CREDENTIALS = True
CORS_ALLOW_ALL_ORIGINS = True  # 开发环境
```

---

## 🎯 关键理解

1. **Vue 前端是独立 SPA**，不需要集成到 Django 模板
2. **访问 Vue 前端**：`http://localhost:8080`
3. **Django 后端**：`http://localhost:8000`（提供 API，React 前端页面可忽略）
4. **前端通过 Vite 代理访问后端**，不需要直接访问 8000 端口

---

## ⚠️ 注意事项

1. **不要访问** `http://localhost:8000/`（那是 React 前端页面）
2. **应该访问** `http://localhost:8080`（Vue 前端）
3. **静态文件 404** 是正常的（Vue 前端独立运行，不需要 Django 的静态文件）
4. **API 路径**：前端通过 `/api` 访问，Vite 会代理到 `http://localhost:8000/api`

---

## 🚀 开发流程

1. **启动后端**：`python manage.py runserver 0.0.0.0:8000`
2. **启动前端**：`cd frontend-vue && npm run dev`
3. **访问前端**：`http://localhost:8080`
4. **前端自动通过代理访问后端 API**

---

## ✅ 当前状态

- ✅ Vue 前端独立运行（正确）
- ✅ Django 后端提供 API（正确）
- ✅ CORS 配置正确
- ✅ Vite 代理配置正确
- ✅ 前后端分离架构（正确）

**总结**：当前架构是正确的，Vue 前端应该独立运行在 8080 端口，通过代理访问后端 API。

